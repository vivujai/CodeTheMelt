<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Connection Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #000; color: #0ff; }
        .test-result { margin: 10px 0; padding: 10px; border: 1px solid #0ff; }
        .success { border-color: #0f0; color: #0f0; }
        .error { border-color: #f00; color: #f00; }
        button { background: #000; color: #0ff; border: 1px solid #0ff; padding: 10px; margin: 5px; cursor: pointer; }
        button:hover { background: #0ff; color: #000; }
    </style>
</head>
<body>
    <h1>Ice Sheet Visualization API Connection Test</h1>
    
    <button onclick="testDetailAPI()">Test Detail API</button>
    <button onclick="testVisualizationAPI()">Test Visualization API</button>
    <button onclick="testHealthAPI()">Test Health API</button>
    
    <div id="results"></div>
    
    <script>
        const resultsDiv = document.getElementById('results');
        
        function addResult(message, isSuccess = true) {
            const div = document.createElement('div');
            div.className = `test-result ${isSuccess ? 'success' : 'error'}`;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong>: ${message}`;
            resultsDiv.appendChild(div);
        }
        
        async function testDetailAPI() {
            try {
                addResult('Testing Detail API for Greenland...');
                const response = await fetch('http://localhost:8080/api/icesheet/GREENLAND/details');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                addResult(`✓ Detail API Success: Size=${data.currentSize}, Temp=${data.ambientTemperature}°C, Rate=${data.meltingRate} kg/s`);
                
                // Test Antarctica too
                const antarcticaResponse = await fetch('http://localhost:8080/api/icesheet/ANTARCTICA/details');
                const antarcticaData = await antarcticaResponse.json();
                addResult(`✓ Antarctica Detail API Success: Size=${antarcticaData.currentSize}, Temp=${antarcticaData.ambientTemperature}°C, Rate=${antarcticaData.meltingRate} kg/s`);
                
            } catch (error) {
                addResult(`✗ Detail API Failed: ${error.message}`, false);
            }
        }
        
        async function testVisualizationAPI() {
            try {
                addResult('Testing Visualization API...');
                
                // Test all time periods
                const periods = ['ANNUAL', 'DECADE', 'CENTURY'];
                const iceSheets = ['GREENLAND', 'ANTARCTICA'];
                
                for (const iceSheet of iceSheets) {
                    for (const period of periods) {
                        const response = await fetch(`http://localhost:8080/api/icesheet/${iceSheet}/visualization?period=${period}`);
                        
                        if (!response.ok) {
                            throw new Error(`HTTP ${response.status} for ${iceSheet}/${period}`);
                        }
                        
                        const data = await response.json();
                        addResult(`✓ ${iceSheet} ${period}: Mass Loss=${Math.abs(data.massLoss).toLocaleString()} kg, Initial=${data.initialSize.toLocaleString()} km²`);
                    }
                }
                
            } catch (error) {
                addResult(`✗ Visualization API Failed: ${error.message}`, false);
            }
        }
        
        async function testHealthAPI() {
            try {
                addResult('Testing Health API...');
                const response = await fetch('http://localhost:8080/api/icesheet/health');
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                addResult(`✓ Health API Success: Status=${data.status}, Calculator Requests=${data.totalCalculatorRequests}, Concurrent=${data.currentConcurrentRequests}`);
                
            } catch (error) {
                addResult(`✗ Health API Failed: ${error.message}`, false);
            }
        }
        
        // Auto-run tests on page load
        window.addEventListener('load', () => {
            addResult('Starting API connection tests...');
            setTimeout(() => testHealthAPI(), 500);
            setTimeout(() => testDetailAPI(), 1000);
            setTimeout(() => testVisualizationAPI(), 2000);
        });
    </script>
</body>
</html>
</content>
</invoke>